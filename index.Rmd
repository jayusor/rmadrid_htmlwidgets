---
title: "RMadrid: htmlwidgets"
subtitle: "Grupo de R y Python de Madrid"
author: 'Jorge Ayuso Rejas'
date: "Abril 2017"

output:
  xaringan::moon_reader:
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = TRUE,cache=FALSE)
```
class: inverse, center, middle

#  ¿el principio del fin de ggplot?

---

## Tipos de gráficos (según yo)

Cuando estoy trabajando con datos distingo dos tipos de gráficos:

&nbsp;   

--

### los míos

Suelen ser feos, técnicos y que uso de manera exploratoria para entender los datos.

&nbsp;   

--


### para otros

Suelen ser más bonitos, fáciles de entender y autoexplicativos (por lo menos intento que sean así...).

---

.left-column[
## Gráficos básicos
*en la intimidad*
]
.right-column[

&nbsp;  
&nbsp;  

```{r,fig.align='center',fig.width=10,fig.height=6}
par(mfrow=c(1,2))
boxplot(Sepal.Length~Species,iris,col=2:4)
plot(density(iris$Sepal.Length))
```
]
---


.left-column[
## Gráficos de calidad
`ggplot2`
]
.right-column[

```{r,include=FALSE}
data(Titanic)
Titanic<-as.data.frame(Titanic)
Titanic<-aggregate(Freq~Class+Sex+Survived,Titanic,sum)
library(ggplot2)
```

```{r,fig.align='center',fig.width=10,fig.height=6}
ggplot(
  Titanic,
  aes(x = Survived,y = Freq,fill = Class)
) + 
geom_bar(stat = "identity") +
facet_wrap(~Sex) + theme_bw() + 
scale_fill_manual(
  values = c("#69D2E7","#A7DBD8","#E0E4CC","#F38630")
)
```
]

---
## ¿Cuántas veces imprimes una presentación?


> *Esto me lo pones en una PPT*


&nbsp;   


> *Esto está muy bien pero mejor una PPT*

&nbsp;   

--

.center[
![gif](https://media.giphy.com/media/IRfWw6HOhknQs/giphy.gif)
]


---
class: center, middle, inverse
## Los gráficos javascript  molan

![js](./img/Mmww2.png)

---
.left-column[
## Gráficos javascript

]
.right-column[

Los gráficos en `javascript` son interactivos, están diseñados por y para las webs pero también podemos usarlos en presentaciones (como en esta!), no se pixelan, y nos puende aportar mucha más información con un click.


&nbsp;   


> OK, me has convencido, pero yo no sé `javascript`...

&nbsp;   


¡No pasa nada! Desde `R` podemos crearlos sin tener ni idea.


:D

]

---
.left-column[
## Gráficos javascript
## Ejemplos
]
.right-column[
Existen multitud de paquetes

* googleVis: https://cran.r-project.org/web/packages/googleVis/vignettes/googleVis_examples.html
* rCharts: http://ramnathv.github.io/rCharts/
* ggvis: http://ggvis.rstudio.com/
* plotly: https://plot.ly/r/
* rbokeh: http://hafen.github.io/rbokeh/
* dygraphs: https://rstudio.github.io/dygraphs/
* leaflet: https://rstudio.github.io/leaflet/
* highcharter: http://jkunst.com/highcharter/
* DiagrammeR: http://rich-iannone.github.io/DiagrammeR/
* ...

]

---
.left-column[
## Gráficos javascript
## Ejemplos
### - highcharter

]
.right-column[
highcharter es un  nos permite hacer cosas
```{r,include=FALSE}
library(highcharter)
data(mpg, package = "ggplot2")

```

```{r,fig.width=8,fig.height=5,fig.align='center'}
library(highcharter)
hchart(
  mpg, "scatter",
  hcaes(x = displ, y = hwy, group = class)
)
```

]

---
.left-column[
## Gráficos javascript
## Ejemplos
### - highcharter
### - dygraphs

]
.right-column[
dygraph para series temporales
```{r,fig.width=8,fig.height=5,fig.align='center'}
library(dygraphs)
cbind(mdeaths, fdeaths) %>% 
  dygraph() %>% dyRangeSelector()
```
]


---
.left-column[
## Gráficos javascript
## Ejemplos
### - highcharter
### - dygraphs
### - leaflet

]
.right-column[
dygraph para series temporales
```{r,fig.width=8,fig.height=5,fig.align='center'}
library(leaflet)
leaflet() %>%
  addTiles() %>%
  addMarkers(
    lng=-3.6959795, lat=40.41052682,
    popup="Meetup R"
  )
```
]

---
.left-column[
## Gráficos javascript
## Ejemplos
### - highcharter
### - dygraphs
### - leaflet
### - DiagrammeR

]
.right-column[
`diagrammeR`
```{r,fig.width=8,fig.height=5,fig.align='center'}
library(DiagrammeR)
grViz("
  digraph {
    layout = twopi
    node [shape = circle]
    A -> {B C D} 
}")
```
]



---
class: center, middle, inverse
## ¿Qué tienen en común?

---
class: center, middle
# htmlwidgets

http://www.htmlwidgets.org/



---
## htmlwidgets


&nbsp;   



> Bring the best of JavaScript data visualization to R

&nbsp;

--
+ Pudes usar los gráficos como un `plot` desde la consola

```{r,eval=FALSE}
library(highcharter)
hchart(AirPassengers)
```

--
+ Es totalmente compatible con `rmarkdown` y `shiny`
```{r,eval=FALSE}
outpus$serie <- renderHighchart({
  hchart(input$data)  
})
```


--
+ Nos facilita mucho crear nuevos paquetes...


---
## He venido a hablar de mi paquete:    

&nbsp;   

<center>
<h2><tt>LiquidGaugeR</tt></h2>


```{r,echo=FALSE,fig.width=4,fig.height=4}
library(LiquidGaugeR)
liquid_gauge(37)
```

</center>



---
.left-column[
## LiquidGaugeR
### - Idea inicial

]
.right-column[

En la web de `htmlwidget` existe un tutorial de como crear nuevos paquetes:


http://www.htmlwidgets.org/develop_intro.html


&nbsp;   


Quería probar así que busqué un gráfico fácil y sencillo:

&nbsp;   

<style>
.container {
  display: flex; /* or inline-flex */
  justify-content: space-between 
}
</style>

.container[
```{r,echo=FALSE,fig.width=2,fig.height=2}
liquid_gauge(25)
```
```{r,echo=FALSE,fig.width=2,fig.height=2}
list(
  circleThickness= 0.15,
  circleColor= "#808015",
  textColor= "#555500",
  waveTextColor= "#FFFFAA",
  waveColor= "#AAAA39",
  textVertPosition= 0.8,
  waveAnimateTime= 1000,
  waveHeight= 0.05,
  waveAnimate= TRUE,
  waveRise= TRUE,
  waveOffset= 0.25,
  textSize= 0.75,
  waveCount= 3
) -> opciones1
liquid_gauge(75,options = opciones1)
```
```{r,echo=FALSE,fig.width=2,fig.height=2}
list(
  circleColor= "#FF7777",
  textColor= "#FF4444",
  waveTextColor= "#FFAAAA",
  waveColor= "#FFDDDD",
  circleThickness= 0.2,
  textVertPosition= 0.2,
  waveAnimateTime= 1000,
  backgroundColor= "#e0e0e0",
  valueCountUpAtStart= FALSE,
  waveRiseAtStart= T
) -> opciones2
liquid_gauge(46,opciones2)
```
]
http://bl.ocks.org/brattonc/5e5ce9beee483220e2f6

  

]

---
class: center, middle, inverse
# ¡Gracias!
### ¿Dudas?
